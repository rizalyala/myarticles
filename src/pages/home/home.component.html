@if (loading()) {
  <app-skeleton-loader />
} @else if(error(); as errorMessage) {
    <div class="text-center py-16 px-4">
      <svg class="mx-auto h-12 w-12 text-rose-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" />
      </svg>
      <h3 class="mt-2 text-lg font-semibold text-slate-900">Gagal Memuat Konten</h3>
      <p class="mt-1 text-sm text-slate-600">
        {{ errorMessage }}
      </p>
    </div>
}
@else {
  @if (selectedArticle(); as article) {
    <app-article-view 
      [article]="article" 
      (backToList)="onBackToList()" />
  } @else {
    <div class="animate-fade-in">
      @if (hasContent()) {
         @if (filteredArticles().length > 0) {
          <app-article-list 
            [articles]="filteredArticles()" 
            (articleSelected)="onArticleSelect($event)" />
        } @else {
          <div class="text-center py-16">
            <svg class="mx-auto h-12 w-12 text-slate-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
              <path vector-effect="non-scaling-stroke" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
            </svg>
            <h3 class="mt-2 text-sm font-medium text-slate-900">Tidak ada artikel ditemukan</h3>
            <p class="mt-1 text-sm text-slate-500">
                Coba sesuaikan kata kunci pencarian Anda atau hapus filter.
            </p>
          </div>
        }
      } @else {
        <div class="text-center py-16 px-4 bg-indigo-50 rounded-lg border border-indigo-200">
          <svg class="mx-auto h-12 w-12 text-slate-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
              <path vector-effect="non-scaling-stroke" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 13h6m-3-3v6m-9 1V7a2 2 0 012-2h6l2 2h6a2 2 0 012 2v8a2 2 0 01-2 2H5a2 2 0 01-2-2z"></path>
          </svg>
          <h3 class="mt-2 text-lg font-semibold text-slate-900">Belum ada artikel</h3>
          <p class="mt-1 text-sm text-slate-600 max-w-2xl mx-auto">
              Sepertinya blog Anda belum memiliki postingan, atau blog tersebut belum diatur sebagai "Publik".
          </p>
          <div class="mt-6 text-left inline-block">
              <h4 class="text-md font-semibold text-slate-800 mb-2">Langkah yang Harus Diperiksa:</h4>
              <ol class="list-decimal list-inside space-y-2 text-sm text-slate-600">
                  <li>Buka dashboard <strong>Blogger.com</strong> Anda.</li>
                  <li>Pastikan Anda sudah menulis dan <strong>mempublikasikan</strong> setidaknya satu postingan (bukan hanya disimpan sebagai draf).</li>
                  <li>Masuk ke <strong>Setelan</strong> &rarr; <strong>Dasar</strong>.</li>
                  <li>Di bawah bagian "Izin", pastikan "Akses pembaca" diatur ke <strong>"Publik"</strong>.</li>
                  <li>Setelah disimpan, kembali ke sini dan muat ulang halaman.</li>
              </ol>
          </div>
        </div>
      }
    </div>
  }
}

<!-- Optimized Search FAB -->
<button 
  (click)="isSearchVisible() ? closeSearch() : openSearch()"
  [class]="'fixed bottom-6 right-6 text-white rounded-full p-4 shadow-lg transform hover:scale-110 transition-all duration-300 z-40 ' + (isSearchVisible() ? 'bg-rose-600 hover:bg-rose-700' : 'bg-indigo-600 hover:bg-indigo-700')"
  [attr.aria-label]="isSearchVisible() ? 'Tutup pencarian' : 'Cari artikel'">
  <div class="relative h-6 w-6 flex items-center justify-center">
    <!-- Search Icon -->
    <svg 
      [class]="'h-6 w-6 transition-all duration-300 ' + (isSearchVisible() ? 'opacity-0 transform -rotate-90 scale-0' : 'opacity-100 transform rotate-0 scale-100')"
      xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
      <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
    </svg>
    <!-- Close Icon -->
    <svg 
      [class]="'absolute h-6 w-6 transition-all duration-300 ' + (isSearchVisible() ? 'opacity-100 transform rotate-0 scale-100' : 'opacity-0 transform rotate-90 scale-0')"
      xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
      <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
    </svg>
  </div>
</button>

<!-- Search Overlay -->
@if (isSearchVisible()) {
  <div (click)="closeSearch()" class="fixed inset-0 bg-black/70 z-30 animate-fade-in">
    <div (click)="$event.stopPropagation()" class="relative w-full max-w-xl mx-auto mt-[20vh] animate-slide-down">
      <input 
        type="text" 
        placeholder="Ketik untuk mencari artikel..."
        [value]="searchQuery()"
        (input)="onSearchChanged($event)"
        autofocus
        class="w-full text-lg sm:text-2xl p-4 pr-12 rounded-lg border-0 shadow-xl bg-white focus:ring-2 focus:ring-indigo-500 focus:outline-none"
      />
      <button (click)="closeSearch()" class="absolute top-0 right-0 h-full px-4 text-gray-400 hover:text-gray-600" aria-label="Tutup pencarian">
        <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>
    </div>
  </div>
}